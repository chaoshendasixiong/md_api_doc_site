<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>123</title>
  <script src="js/vue.min.js"></script>
  <script src="js/axios.min.js"></script>
  <script src="js/marked.js"></script>
  <script src="js/highlight.min.js"></script>
  <script src="js/highlightjs-line-numbers.min.js"></script>
  <link rel="stylesheet" href="css/monokai_sublime.min.css">
  <link rel="stylesheet" href="css/pure-min.css">
  <link rel="stylesheet" href="css/grids-responsive-min.css">
  <link rel="stylesheet" href="css/default.css">
  <link rel="stylesheet" href="css/user.css">
</head>
<body>
  <div id="app" >
    <div id="id_toc"></div>
    <div id="layout" v-bind:class="{active:isActive}"> 
      <div>
        <a href="#menu" id="menuLink" class="menu-link " v-on:click="toggle_leftmenu">
            <!-- Hamburger icon -->
            <span></span>
        </a>
        <div id="menu">
          <div class="pure-menu">
            <a class="pure-menu-heading" href="#INFO">INFO</a>
            <ul class="pure-menu-list">
              <li class="pure-menu-item" v-for="(item, index) of mdLists" v-bind:key="index+item.name">
                 <a :href="item.name" v-on:click="show_md($event)" class="pure-menu-link">{{ item.info }} </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div id="main">
        <div class="header">
          <h1>Page Title</h1>
          <h2>A subtitle for your page goes here</h2>
        </div>
        <div v-html="mdContent" v-highlight></div>
      </div>
    </div>
  </div>
</body>
<script>
  var axios = axios.create()
  Vue.directive('highlight',function (el) { 
    let blocks = el.querySelectorAll('pre code');
    blocks.forEach((block)=>{ hljs.highlightElement(block);hljs.lineNumbersBlock(block); })
  })
  var app = new Vue({
    el: '#app',
    data: {
      mdLists: [
        {info:"test",            name:"md/example.md"},
      ],
      mdContent: "",
      isActive: false,
      header: 0
    },
    methods: {
      toggle_leftmenu: function () {
        this.isActive = !this.isActive
      },
      show_md: function(e) {
        e.preventDefault()
        var mdName = e.target.getAttribute('href')
        let self = this;
        axios
          .get(mdName)
          .then(function (response) {
            let start = `<div class=" pure-g"><div class="pure-u-1">`;
            let end = `</div></div>`;
            self.mdContent = start+marked(response.data)+end;
      
          })
          .catch(function (error) {
            console.log(error);
          });
      },
    },
    mounted: function () {
        const renderer = {
          heading(text, level, raw, slugger) {
            if(level == 3) {
              this.header = 3
              return `
                </div></div> <div class=" pure-g">
              <div class="pure-u-1 pure-u-xl-1-2">
                  <h${level}>${text}</h${level}>
              `; 
            }else if(level == 4){
              if(this.header == 3) {
                this.header = 4
                return  `
                  </div><div class="right-dark pure-u-1 pure-u-xl-1-2">
                    <h${level}>${text}</h${level}>
                `;
              }else {
                return false;
              }
            } 
            return false;
          }
        };
        marked.use({ renderer });
      },
  })
</script>

</html>